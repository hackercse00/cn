#include<stdio.h>
struct sjf{
	int pid,p,at,bt,st,ft,tat,wt;
};
void main(){
	int i,j,k,n,a=0;
	float tavg=0,wavg=0;
	printf("Enter the number of process :");
	scanf("%d",&n);
	struct sjf f[n],temp;
	for(i=0;i<n;i++){
		printf("Enter the process id :");
		scanf("%d",&f[i].pid);
		printf("\tEnter the priority :");
		scanf("%d",&f[i].p);
		printf("\tEnter the arrival time :");
		scanf("%d",&f[i].at);
		printf("\tEnter the burst time :");
		scanf("%d",&f[i].bt);
	}
	for(i=0;i<n;i++){
		for(j=i+1;j<n;j++){
			if(f[i].at>f[j].at || (f[i].at==f[j].at && f[i].p>f[j].p)){
				temp=f[i];
				f[i]=f[j];
				f[j]=temp;
			}
		}
	}
	f[0].st=f[0].at;
	f[0].ft=f[0].st+f[0].bt;
	for(i=0;i<n;i++){
		for(j=n-1;j>i;j--){
			if(f[j].at<=f[i].st+f[i].bt){
				a=j;
				break;
			}
			else{
				a=i+1;
			}
		}
		for(j=i+1;j<=a;j++){
			for(k=j+1;k<=a;k++){
				if(f[j].p>f[k].p){
					temp=f[j];
					f[j]=f[k];
					f[k]=temp;
				}
			}
		}
		if(f[i+1].at>f[i].st+f[i].bt){
		        f[i+1].st=f[i+1].at;
		    }
		    else{
		    	f[i+1].st=f[i].st+f[i].bt;
			}
	}
	for(i=0;i<n;i++){
		f[i].ft=f[i].st+f[i].bt;
		f[i].wt=f[i].st-f[i].at;
		f[i].tat=f[i].ft-f[i].at;
		wavg=wavg+f[i].wt;
		tavg=tavg+f[i].tat;
	}
	printf("Process\tArrivalTime\tBurstTime\tPriority\tStartTime\tFinalTime\tWaitTime\tTurnaroundTime\n");
        for(i=0;i<n;i++)
        {
                printf("%d\t%d\t\t%d\t\t%d\t\t%d\t\t%d\t\t%d\t\t%d\n",f[i].pid,f[i].at,f[i].bt,f[i].p,f[i].st,f[i].ft,f[i].wt,f[i].tat);
        }
        printf("The average waiting time is : %2f\n",wavg/n);
        printf("The average turn around time is : %2f\n",tavg/n);
}
