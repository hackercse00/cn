//mft
#include<stdio.h>
#include<limits.h>
void main(){
        int m,p,am,n,x,o,count=0,i,j,k,sum=0,c,min;
        float s;
        printf("Enter the size of the memory : ");
        scanf("%d",&m);
        printf("Enter the memory used by th os : ");
        scanf("%d",&o);
        am=m-o;
        printf("Available memory = %d\n",am);
        printf("Enter the number of process : ");
        scanf("%d",&p);
        int alloc[p];
        float mp[p],intf[p];
        for(i=0;i<p;i++){
                printf("Enter the memory required for the process %d : ",i+1);
                scanf("%f",&mp[i]);
                alloc[i]=0;
        }
      k:printf("Enter 1 for equal partition and 0 for unequal partition : ");
        scanf("%d",&x);
        if(x==1){
                printf("Enter the number of partitions : ");
                scanf("%d",&n);
                s=(float)am/n;
                printf("Size of partitions = %0.2f\n",s);
                for(i=0;i<p;i++){
                        if(mp[i]<=s){
                                alloc[i]=++count;
                                intf[i]=s-mp[i];
                        }
                        if(count==n){
                                break;
                        }
                }
        }
        else if(x==0){
                printf("Enter the number of partitions : ");
                scanf("%d",&n);
                int t[n],a[n];
                for(i=0;i<n-1;i++){
                        printf("Enter the size of the partition %d : ",i+1);
                        scanf("%d",&t[i]);
                        sum=sum+t[i];
                        a[i]=-1;
                }
                t[n-1]=am-sum;
                 a[n-1]=-1;
                printf("Select the choice : 1.Best fit\t2.Worst fit\t3.First fit\t4.Next fit  : ");
                scanf("%d",&c);
                switch(c){
                        case 1:
                                count=0;
                                for(i=0;i<p;i++){
                                        k=-1,min=INT_MAX;
                                        for(j=0;j<n;j++){
                                                if(t[j]<min && mp[i]<=t[j] && a[j]==-1){
                                                        min=t[j];
                                                        k=j;
                                                }
                                        }
                                        if(k==-1){
                                                continue;
                                        }
                                        alloc[i]=k+1;
                                        intf[i]=t[k]-mp[i];
                                        a[k]=1;
                                        if(++count==n){
                                                break;
                                        }
                                }
                                break;
                        case 2:
                                count=0;
                                for(i=0;i<p;i++){
                                        k=-1,min=-1;
                                        for(j=0;j<n;j++){
                                                if(t[j]>min && mp[i]<=t[j] && a[j]==-1){
                                                        min=t[j];
                                                        k=j;
                                                }
                                        }
                                        if(k==-1){
                                                continue;
                                        }
                                        alloc[i]=k+1;
                                        intf[i]=t[k]-mp[i];
                                        a[k]=1;
                                        if(++count==n){
                                                break;
                                        }
                                }
                                break;
                        case 3:
                                count=0;
                                for(i=0;i<p;i++){
                                        for(j=0;j<n;j++){
                                                if(mp[i]<=t[j] && a[j]==-1){
                                                        alloc[i]=j+1;
                                                        intf[i]=t[j]-mp[i];
                                                        a[j]=1;
                                                        break;
                                                }
                                        }
                                        if(++count==n){
                                                break;
                                        }
                                }
                                break;
                        case 4:
                                j=0;
                                for(i=0;i<p;i++){
                                        count=0;
                                        while(count++<n){
                                                if(mp[i]<=t[j] && a[j]==-1){
                                                        alloc[i]=j+1;
                                                        intf[i]=t[j]-mp[i];
                                                        a[j]=1;
                                                        break;
                                                }
                                                else if(j==n-1){
                                                        j=0;
                                                }
                                                else{
                                                        j++;
                                                }
                                        }
                                }
                                break;
                }
        }
        printf("process no\tmemory req\tallocation\t\tInternalFragmentation\n");
        for(i=0;i<p;i++){
                printf("%d\t\t%0.2f\t\t",i+1,mp[i]);
                if(alloc[i]==0){
                        printf("Not allocated\t\t--\n");
                }
                else{
                        printf("alloc partition %d\t%0.2f\n",alloc[i],intf[i]);
                }
        }
}
